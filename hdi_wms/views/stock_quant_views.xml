<?xml version="1.0" encoding="utf-8"?>
<odoo>
    <record id="view_quant_list_wms" model="ir.ui.view">
        <field name="name">stock.quant.list.wms</field>
        <field name="model">stock.quant</field>
        <field name="inherit_id" ref="stock.view_stock_quant_tree"/>
        <field name="arch" type="xml">
            <field name="location_id" position="after">
                <field name="batch_id" optional="hide" groups="hdi_wms.group_wms_user"/>
            </field>
        </field>
    </record>
    <record id="view_wms_inventory_check_batch_list" model="ir.ui.view">
        <field name="name">wms.inventory.check.batch.list</field>
        <field name="model">stock.quant</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">

            <list string="Kiểm kê theo Batch" editable="bottom"
                  create="1" delete="1"
                  default_order="location_id, product_id">

                <field name="check_type" invisible="1"/>
                <field name="location_id"
                       required="1"
                       domain="[('usage', 'in', ['internal', 'transit'])]"/>

                <field name="batch_id"
                       required="1"
                       domain="[('location_id', '=', location_id)]"
                       options="{'no_create': True}"/>

                <field name="product_id" readonly="1" options="{'no_create': True}"/>
                <field name="lot_id" groups="stock.group_production_lot" readonly="1"/>
                <field name="package_id" groups="stock.group_tracking_lot" readonly="1"/>

                <field name="quantity" string="Số lượng hệ thống" readonly="1"/>
                <field name="inventory_quantity" string="Số lượng kiểm đếm" required="1"/>

                <field name="inventory_diff_quantity"
                       string="Chênh lệch"
                       readonly="1"
                       decoration-danger="inventory_diff_quantity &lt; 0"
                       decoration-success="inventory_diff_quantity &gt; 0"/>

                <field name="product_uom_id" groups="uom.group_uom"/>

                <button name="action_apply_inventory"
                        type="object"
                        string="Áp dụng"
                        class="btn-primary"
                        icon="fa-save"/>
            </list>
        </field>
    </record>
    <record id="view_wms_inventory_check_barcode_list" model="ir.ui.view">
        <field name="name">wms.inventory.check.barcode.list</field>
        <field name="model">stock.quant</field>
        <field name="priority">20</field>
        <field name="arch" type="xml">

            <list string="Kiểm kê quét Barcode" editable="bottom"
                  create="1" delete="1"
                  default_order="location_id, product_id">

                <field name="check_type" invisible="1"/>
                <field name="location_id"
                       required="1"
                       domain="[('usage', 'in', ['internal', 'transit'])]"/>

                <field name="product_id" options="{'no_create': True}"/>
                <field name="lot_id" groups="stock.group_production_lot"/>

                <field name="scan_mode"
                       widget="boolean_toggle"
                       string="Chế độ quét"/>

                <field name="last_scanned_code"
                       readonly="1"
                       string="Mã vừa quét"
                       placeholder="Chưa quét..."/>

                <field name="scanned_count"
                       readonly="1"
                       string="Lần quét"
                       decoration-info="scanned_count &gt; 0"/>

                <field name="quantity" string="Số lượng hệ thống" readonly="1"/>
                <field name="inventory_quantity" string="Số lượng kiểm đếm" required="1"/>

                <field name="inventory_diff_quantity"
                       string="Chênh lệch"
                       readonly="1"
                       decoration-danger="inventory_diff_quantity &lt; 0"
                       decoration-success="inventory_diff_quantity &gt; 0"/>

                <field name="product_uom_id" groups="uom.group_uom"/>

                <button name="action_apply_inventory"
                        type="object"
                        string="Áp dụng"
                        class="btn-primary"
                        icon="fa-save"/>
            </list>
        </field>
    </record>

    <record id="action_wms_inventory_check_batch" model="ir.actions.act_window">
        <field name="name">Kiểm kê theo Batch</field>
        <field name="res_model">stock.quant</field>
        <field name="view_mode">list</field>
        <field name="view_id" ref="view_wms_inventory_check_batch_list"/>
        <field name="domain">[('check_type', '=', 'batch')]</field>
        <field name="context">
            {'default_check_type': 'batch', 'inventory_mode': True}
        </field>
    </record>

    <record id="action_wms_inventory_check_barcode" model="ir.actions.act_window">
        <field name="name">Kiểm kê quét Barcode</field>
        <field name="res_model">stock.quant</field>
        <field name="view_mode">list</field>
        <field name="view_id" ref="view_wms_inventory_check_barcode_list"/>
        <field name="domain">[('check_type', '=', 'barcode')]</field>
        <field name="context">
            {'default_check_type': 'barcode', 'inventory_mode': True}
        </field>
    </record>
</odoo>
